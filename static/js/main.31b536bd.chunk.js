(this.webpackJsonpbattleline=this.webpackJsonpbattleline||[]).push([[0],{31:function(e,t,r){e.exports=r(47)},36:function(e,t,r){},47:function(e,t,r){"use strict";r.r(t);var l=r(0),a=r.n(l),n=r(28),s=r.n(n),i=(r(36),r(17)),c=r(18),o=r(1),h=[],p=["r","o","y","g","b","p"],u=["1","2","3","4","5","6","7","8","9","T"],d=new Map([["1",1],["2",2],["3",3],["4",4],["5",5],["6",6],["7",7],["8",8],["9",9],["T",10]]),f=new Map([[1,"1"],[2,"2"],[3,"3"],[4,"4"],[5,"5"],[6,"6"],[7,"7"],[8,"8"],[9,"9"],[10,"T"]]),g=new Map([["ALX",[10,9,8,7,6,5,4,3,2,1]],["DAR",[10,9,8,7,6,5,4,3,2,1]],["CAV",[8]],["321",[3,2,1]]]),y=new Map([["straightflush",5],["set",4],["flush",3],["straight",2],["sum",1],["incomplete",0]]);for(let Z=0;10!==Z;Z++)for(let e=0;6!==e;e++){let t=u[Z]+p[e];h.push(t)}var m=["ALX","DAR","CAV","321","TRA","DES","RDP","SCT","FOG","MUD"];const _={name:"battle-line",setup:()=>{let e=h.slice(),t=m.slice(),r=h.slice(),l=new Array(9).fill(new Array(2).fill([])),a=new Array(2).fill([]),n=new Array(9).fill(null),s=new Array(9).fill(null);C(e),C(t);let i=[];i.push([]),i.push([]);for(let c=0;7!==c;c++)for(let t=0;2!==t;t++)i[t].push(e.pop());return{troop_deck:e,tactics_deck:t,player_hands:i,board_cards:l,discards:a,unseen_cards:r,seen_cards:[],flag_statuses:n,flag_tiebreakers:s,tactics_played:[0,0],leaders_played:[0,0],scout_state:[0,0]}},minPlayers:2,maxPlayers:2,moves:{playCard:function(e,t,r,l){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,n=e.player_hands[t.currentPlayer][r];if(t.numMoves>0&&e.scout_state[1]>0&&0===e.scout_state[0])return-1!==l?o.x:(w(n)?e.troop_deck.push(n):M(n)&&e.tactics_deck.push(n),e.player_hands[t.currentPlayer].splice(r,1),e.scout_state[1]=e.scout_state[1]-1,void(e.scout_state[1]<=1&&(e.scout_state[0]=0,e.scout_state[1]=0,t.events.endTurn())));if(t.numMoves>0)return o.x;if(-1!==l&&(w(n)||S(n)||R(n))){let r=L(e.board_cards[l])?4:3;if(I(e.board_cards[l][t.currentPlayer])===r)return o.x}if(-1!==l&&null!==e.flag_statuses[l])return o.x;if(M(n)){if("0"===t.currentPlayer&&e.tactics_played[0]>e.tactics_played[1])return o.x;if("1"===t.currentPlayer&&e.tactics_played[1]>e.tactics_played[0])return o.x}if(D(n)&&e.leaders_played[t.currentPlayer]>0)return o.x;if(R(n)){if(null===a)return o.x;if(null!==e.flag_statuses[a[0]])return o.x;let r=e.board_cards[a[0]][a[1]][a[2]];if("TRA"===n){if(a[1]===t.currentPlayer||M(r)||-1===l)return o.x}else if("DES"===n){if(a[1]===t.currentPlayer||!G(r)||-1!==l)return o.x}else if("RDP"===n&&(a[1]!==t.currentPlayer||!G(r)||l===a[0]))return o.x}else if(F(n)){if(-1!==l)return o.x;let t=Math.min(3,e.troop_deck.length+e.tactics_deck.length);e.scout_state=[t,0]}else if(-1===l)return o.x;if(R(n)){let r=e.board_cards[a[0]][a[1]][a[2]];e.board_cards[a[0]][a[1]].splice(a[2],1),-1!==l?e.board_cards[l][t.currentPlayer].push(r):e.discards[a[1]].push(r),e.discards[t.currentPlayer].push(n),e.flag_tiebreakers[a[0]]===a[1]&&(e.flag_tiebreakers[a[0]]=null)}else F(n)?e.discards[t.currentPlayer].push(n):(e.board_cards[l][t.currentPlayer].push(n),"MUD"===n&&(e.flag_tiebreakers[l]=null));if(-1!==l){let r=L(e.board_cards[l])?4:3;(s=v(l,t.currentPlayer,e.board_cards))[0].length===r&&null===e.flag_tiebreakers[l]&&(e.flag_tiebreakers[l]=t.currentPlayer)}if(null!==a){var s;let r=L(e.board_cards[a[0]])?4:3;(s=v(a[0],t.currentPlayer,e.board_cards))[0].length===r&&null===e.flag_tiebreakers[a[0]]?e.flag_tiebreakers[a[0]]=t.currentPlayer:s[1].length===r&&null===e.flag_tiebreakers[a[0]]&&(e.flag_tiebreakers[a[0]]=O(t.currentPlayer))}e.seen_cards.push(n),M(n)&&e.tactics_played[t.currentPlayer]++,D(n)&&e.leaders_played[t.currentPlayer]++;var i=e.unseen_cards.indexOf(n);-1!==i&&e.unseen_cards.splice(i,1),e.player_hands[t.currentPlayer].splice(r,1)},claimFlag:{move:(e,t,r)=>{if(null!==e.flag_statuses[r])return o.x;let l=function(e){for(let t=0;2!==t;t++)for(let r=0;r!==e[t].length;r++)if("FOG"===e[t][r])return!0;return!1}(e.board_cards[r]),a=L(e.board_cards[r]);var n=v(r,t.currentPlayer,e.board_cards);if(!function(e,t,r,l,a,n){var s=function(e,t,r){let l=r?4:3;if(e.length!==l)return["incomplete",0];var a=T(e);if(t)return["sum",a];var n=E(e),s=b(e,r),i=x(e);return-1!==n&&-1!==s?["straightflush",s]:-1!==i?["set",i]:-1!==n?["flush",n]:-1!==s?["straight",s]:["sum",a]}(e,l,a),i=function(e,t,r,l){let a=-1;if(!r){if(a=function e(t,r,l){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;null===a&&(a=r.length);let n=E(t),s=b(t,l);if(-1===n||-1===s)return-1;let i=l?4:3;if(t.length===i)return s;for(let p=a-1;p>=0;p--){var c=t.slice(),o=r.slice();c.push(r[p]),o.splice(p,1);var h=e(c,o,l,p);if(-1!==h)return h}return-1}(e,t,l),-1!==a)return["straightflush",a];if(a=function e(t,r,l){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;null===a&&(a=r.length);let n=x(t);if(-1===n)return-1;let s=l?4:3;if(t.length===s)return n;for(let h=a-1;h>=0;h--){var i=t.slice(),c=r.slice();i.push(r[h]),c.splice(h,1);var o=e(i,c,l,h);if(-1!==o)return o}return-1}(e,t,l),-1!==a)return["set",a];if(a=function e(t,r,l){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;null===a&&(a=r.length);let n=E(t);if(-1===n)return-1;let s=l?4:3;if(t.length===s)return n;for(let h=a-1;h>=0;h--){var i=t.slice(),c=r.slice();i.push(r[h]),c.splice(h,1);var o=e(i,c,l,h);if(-1!==o)return o}return-1}(e,t,l),-1!==a)return["flush",a];if(a=function e(t,r,l){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;null===a&&(a=r.length);let n=b(t,l);if(-1===n)return-1;let s=l?4:3;if(t.length===s)return n;for(let h=a-1;h>=0;h--){var i=t.slice(),c=r.slice();i.push(r[h]),c.splice(h,1);var o=e(i,c,l,h);if(-1!==o)return o}return-1}(e,t,l),-1!==a)return["straight",a]}if(a=function e(t,r,l){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;null===a&&(a=r.length);let n=T(t),s=l?4:3;if(t.length===s)return n;for(let h=a-1;h>=0;h--){var i=t.slice(),c=r.slice();i.push(r[h]),c.splice(h,1);var o=e(i,c,l,h);if(-1!==o)return o}return-1}(e,t,l),-1!==a)return["sum",a];return["incomplete",a]}(t,r,l,a);return function(e,t,r){return y.get(e[0])>y.get(t[0])||!(y.get(e[0])<y.get(t[0]))&&(e[1]>t[1]||!(e[1]<t[1])&&r)}(s,i,n)}(n[0],n[1],e.unseen_cards,l,a,e.flag_tiebreakers[r]===t.currentPlayer))return o.x;e.flag_statuses[r]=t.currentPlayer},noLimit:!0},drawCard:{move:(e,t,r)=>{if(0===t.numMoves)return o.x;if((0!=e.scout_state[0]||0!=e.scout_state[1])&&e.scout_state[0]<=e.scout_state[1])return o.x;if("troop"===r&&0===e.troop_deck.length)return o.x;if("tactics"===r&&0===e.tactics_deck.length)return o.x;if("troop"===r)e.player_hands[t.currentPlayer].push(e.troop_deck.pop());else{if("tactics"!==r)return o.x;e.player_hands[t.currentPlayer].push(e.tactics_deck.pop())}if(0!=e.scout_state[0]||0!=e.scout_state[1])return e.scout_state[1]=e.scout_state[1]+1,void(e.scout_state[0]===e.scout_state[1]&&(e.scout_state[0]=0));t.events.endTurn()},client:!1},passTurn:(e,t)=>{if(!P(e,t))return o.x;t.events.endTurn()}},playerView:(e,t,r)=>function(e,t){var r=new Array(e.troop_deck.length).fill("troop"),l=new Array(e.tactics_deck.length).fill("tactics"),a=[];for(let s=0;2!==s;s++)if(parseInt(t)===s)a.push(e.player_hands[s]);else{var n=[];for(let t=0;t!==e.player_hands[s].length;t++)w(e.player_hands[s][t])||"troop"===e.player_hands[s][t]?n.push("troop"):n.push("tactics");a.push(n)}return{troop_deck:r,tactics_deck:l,player_hands:a,board_cards:e.board_cards,discards:e.discards,unseen_cards:e.unseen_cards,seen_cards:e.seen_cards,flag_statuses:e.flag_statuses,flag_tiebreakers:e.flag_tiebreakers,tactics_played:e.tactics_played,leaders_played:e.leaders_played,scout_state:e.scout_state}}(e,r),endIf:(e,t)=>{if(function(e,t){var r=0,l=0;for(let a=0;9!==a;a++)if(e[a]===t?(r++,l++):l=0,r>=5||l>=3)return!0;return!1}(e.flag_statuses,t.currentPlayer))return{winner:t.currentPlayer}}};function v(e,t,r){var l=[],a=[];for(let n=0;2!==n;n++)for(let s=0;s!==r[e][n].length;s++)n===parseInt(t)?G(r[e][n][s])&&l.push(r[e][n][s]):G(r[e][n][s])&&a.push(r[e][n][s]);return[l,a]}function E(e){let t=null,r=0;for(let l=0;l!==e.length;l++)if(w(e[l])){if(r+=d.get(e[l][0]),null===t)t=e[l][1];else if(t!==e[l][1])return-1}else r+=g.get(e[l])[0];return r}function b(e,t){for(let r=0;r!==e.length;r++)if(!w(e[r])){let l=g.get(e[r]),a=e[r],n=-1;for(let s=0;s!==l.length;s++){e[r]=f.get(l[s])+"x";let a=b(e,t);a>n&&(n=a)}return e[r]=a,n}return function(e,t){let r=0;for(let a=0;a!==e.length;a++){d.get(e[a][0])>r&&(r=d.get(e[a][0]));for(let r=a+1;r!==e.length;r++){var l=Math.abs(d.get(e[a][0])-d.get(e[r][0]));let n=t?3:2;if(0===l||l>n)return-1}}return e.length*(2*r-e.length+1)/2}(e,t)}function x(e){var t=new Set([1,2,3,4,5,6,7,8,9,10]);for(let r=0;r!==e.length;r++)if(0===(t=w(e[r])?k(t,new Set([d.get(e[r][0])])):k(t,new Set(g.get(e[r])))).size)return-1;return t.values().next().value*e.length}function k(e,t){return new Set([...e].filter(e=>t.has(e)))}function T(e){var t=0;for(let r=0;r!==e.length;r++)2===e[r].length?t+=d.get(e[r][0]):t+=g.get(e[r])[0];return t}function C(e){for(let l=e.length-1;l>=0;l--){var t=Math.floor(Math.random()*(l+1)),r=e[t];e[t]=e[l],e[l]=r}return e}function P(e,t){return 0===t.numMoves?!function(e,t,r,l){let a=!1;for(let n=0;n!==l.length&&!a;n++)w(l[n])&&(a=!0);if(!a)return!1;for(let n=0;9!==n;n++){let l=L(e[n])?4:3;if(I(e[n][t])!==l&&null===r[n])return!0}return!1}(e.board_cards,t.currentPlayer,e.flag_statuses,e.player_hands[t.currentPlayer]):0===e.troop_deck.length&&0===e.tactics_deck.length}function A(e,t,r,l,a,n){return!!G(l)&&(null===e.flag_statuses[n]&&(("TRA"!==r||a!==t.currentPlayer&&!M(l))&&(("DES"!==r||a!==t.currentPlayer)&&("RDP"!==r||a===t.currentPlayer))))}function w(e){return 2===e.length}function M(e){return 3===e.length}function S(e){return["ALX","DAR","CAV","321"].indexOf(e)>=0}function D(e){return["ALX","DAR"].indexOf(e)>=0}function R(e){return["TRA","DES","RDP"].indexOf(e)>=0}function F(e){return["SCT"].indexOf(e)>=0}function G(e){return w(e)||S(e)}function I(e){let t=0;for(let r=0;r!==e.length;r++)G(e[r])&&t++;return t}function L(e){for(let t=0;2!==t;t++)for(let r=0;r!==e[t].length;r++)if("MUD"===e[t][r])return!0;return!1}function O(e){return"0"===e?"1":"0"}var U=new Map([["r","#FF0000"],["o","#FFA500"],["y","#FFFF00"],["g","#008000"],["b","#0000FF"],["p","#800080"]]),N=new Map([["ALX",[["ALEXANDER"],6]],["DAR",[["DARIUS"],9]],["CAV",[["COMPANION","CAVALRY"],6]],["321",[["SHIELD","BEARERS"],8]],["TRA",[["TRAITOR"],9]],["DES",[["DESERTER"],7]],["RDP",[["REDEPLOY"],7]],["SCT",[["SCOUT"],9]],["FOG",[["FOG"],9]],["MUD",[["MUD"],9]]]);class V extends a.a.Component{constructor(e){super(e),this.cardRefs=a.a.createRef(),this.height="deck"===this.props.side?120:150}componentDidMount(){this.updateCanvas()}componentDidUpdate(){this.updateCanvas()}updateCanvas(){const e=this.cardRefs.current.getContext("2d");e.clearRect(0,0,80,this.height);let t="top"===this.props.side&&this.props.selected||"bottom"===this.props.side&&!this.props.selected||"deck"===this.props.side?0:30;e.translate(0,t),2===this.props.str.length?J(e,this.props.str,null):3===this.props.str.length?X(e,this.props.str,null):"troop"===this.props.str?function(e){Y(e,80,120,7,"#000000"),e.fillStyle="#D2B48C",e.fillRect(7,7,66,106),e.font="14px Verdana",e.fillStyle="#000000",e.textAlign="center",e.fillText("TROOP",40,60)}(e):"tactics"===this.props.str&&function(e){Y(e,80,120,7,"#855040"),e.fillStyle="#D2B48C",e.fillRect(7,7,66,106),e.font="14px Verdana",e.fillStyle="#000000",e.textAlign="center",e.fillText("TACTICS",40,60)}(e),e.translate(0,-t)}render(){return a.a.createElement("canvas",{ref:this.cardRefs,width:80,height:this.height})}}class W extends a.a.Component{constructor(e){super(e),this.formationRefs=a.a.createRef()}componentDidMount(){this.updateCanvas()}componentDidUpdate(){this.updateCanvas()}updateCanvas(){const e=this.formationRefs.current.getContext("2d");if(e.clearRect(0,0,80,295),"top"===this.props.side){e.translate(0,175);for(let t=0;t!==this.props.cards.length;t++)2===this.props.cards[t].length?J(e,this.props.cards[t],this.props.highlights[t]):3===this.props.cards[t].length&&X(e,this.props.cards[t],this.props.highlights[t]),e.translate(0,-35);e.translate(0,-35*(5-this.props.cards.length))}else{for(let t=0;t!==this.props.cards.length;t++)2===this.props.cards[t].length?J(e,this.props.cards[t],this.props.highlights[t]):3===this.props.cards[t].length&&X(e,this.props.cards[t],this.props.highlights[t]),e.translate(0,35);e.translate(0,-35*this.props.cards.length)}if(this.props.show_flag){z(e,"top"===this.props.side?35*(7-this.props.cards.length):35*this.props.cards.length)}}render(){return a.a.createElement("canvas",{ref:this.formationRefs,width:80,height:295})}}class B extends a.a.Component{constructor(e){super(e),this.flagRefs=a.a.createRef()}componentDidMount(){this.updateCanvas()}componentDidUpdate(){this.updateCanvas()}updateCanvas(){const e=this.flagRefs.current.getContext("2d");e.clearRect(0,0,80,50),this.props.show_flag&&z(e,0)}render(){return a.a.createElement("canvas",{ref:this.flagRefs,width:80,height:50})}}function J(e,t,r){let l=t[0],a=t[1];null===r&&(r="#FFFFFF"),Y(e,80,120,7,r),e.fillStyle=U.get(a),e.fillRect(7,7,66,106),e.fillStyle="#FFFFFF",e.fillRect(7,7,20,25),e.fillRect(53,88,20,25),e.font="18px Verdana",e.fillStyle="#000000",e.textAlign="center";let n=e.measureText("M").width;for(let s=0;2!==s;s++){if("T"!==l)e.fillText(l,17,19.5+n/2-2);else{let t=4,r=e.measureText("1").width,l=e.measureText("0").width;e.fillText("1",17-r/2+t/2,19.5+n/2-2),e.fillText("0",17+l/2-t/2,19.5+n/2-2)}if("6"===l||"9"===l){let t=e.measureText(l).width;e.lineWidth=1,e.beginPath(),e.moveTo(17-t/2,19.5+n/2+1),e.lineTo(17+t/2,19.5+n/2+1),e.stroke()}e.rotate(Math.PI),e.translate(-80,-120)}}function X(e,t,r){null===r&&(r="#FFFFFF"),Y(e,80,120,7,r),e.fillStyle="#E4DB86",e.fillRect(7,7,66,106),e.fillStyle="#FFFFFF",e.fillRect(7,7,20,25),e.fillRect(53,88,20,25);let l=N.get(t),a=l[0],n=l[1];j(t,e,40,60,40,40);for(let s=0;2!==s;s++){e.font=n.toString()+"px Verdana",e.fillStyle="#000000",e.textAlign="center";let r=e.measureText("M").width;for(let t=0;t!==a.length;t++)e.fillText(a[t],50,(42+r*a.length)/2-r*(a.length-1-t));j(t,e,17,17.5,18,18),e.rotate(Math.PI),e.translate(-80,-120)}3===l.length&&l[2]()}function Y(e,t,r,l,a){e.strokeStyle="#000000",e.fillStyle=a;e.lineWidth=2,e.beginPath(),e.moveTo(l+1,1),e.lineTo(t-l-1,1),e.arcTo(t-1,1,t-1,l+1,l+1),e.lineTo(t-1,r-l-1),e.arcTo(t-1,r-1,t-l-1,r-1,l+1),e.lineTo(l+1,r-1),e.arcTo(1,r-1,1,l+1,l+1),e.lineTo(1,l+1),e.arcTo(1,1,l+1,1,l+1),e.closePath(),e.fill(),e.stroke()}function z(e,t){var r=document.getElementById("flag");e.drawImage(r,15,t,50,50)}function j(e,t,r,l,a,n){"ALX"===e||"DAR"===e?function(e,t,r,l,a){e.strokeStyle="#000000",e.fillStyle="#000000";e.lineWidth=1;let n=[t-(l=.9*l-4)/3,r+(a*=.9)/2],s=[t+l/3,r+a/2],i=[t-l/2,r-a/2+2],c=[t,r-a/2+2],o=[t+l/2,r-a/2+2],h=[t-l/6,r],p=[t+l/6,r];e.beginPath(),e.moveTo(n[0],n[1]),e.lineTo(i[0],i[1]),e.lineTo(h[0],h[1]),e.lineTo(c[0],c[1]),e.lineTo(p[0],p[1]),e.lineTo(o[0],o[1]),e.lineTo(s[0],s[1]),e.lineTo(n[0],n[1]),e.closePath(),e.fill(),e.stroke()}(t,r,l,a,n):"CAV"===e?function(e,t,r,l){e.font=l.toString()+"px Verdana",e.fillStyle="#000000",e.textAlign="center";let a=e.measureText("M").width,n=l<30?0:7;e.fillText("8",t,r+a/2-n)}(t,r,l,n):"321"===e?function(e,t,r,l,a){e.font=(a/2).toString()+"px Verdana",e.fillStyle="#000000",e.textAlign="center";let n=e.measureText("M").width,s=a<30?0:7;e.fillText("321",t,r+n/2-s)}(t,r,l,0,n):"TRA"===e?function(e,t,r,l,a){e.strokeStyle="#000000",e.fillStyle="#000000";e.lineWidth=1;let n=[t-.2*(l=.4*l-4),r-(a*=.9)/2+2],s=[t+.2*l,r-a/2+2],i=[t+.2*l,r+a/2-l],c=[t+l,r+a/2-l],o=[t,r+a/2],h=[t-l,r+a/2-l],p=[t-.2*l,r+a/2-l];e.beginPath(),e.moveTo(n[0],n[1]),e.lineTo(s[0],s[1]),e.lineTo(i[0],i[1]),e.lineTo(c[0],c[1]),e.lineTo(o[0],o[1]),e.lineTo(h[0],h[1]),e.lineTo(p[0],p[1]),e.fill(),e.stroke()}(t,r,l,a,n):"DES"===e?function(e,t,r,l,a){e.strokeStyle="#000000",l=.7*l-4;let n=(a*=.9)/5;e.lineWidth=n;let s=[t-l/2,r-a/2+2],i=[t+l/2,r-a/2+2],c=[t-l/2,r+a/2],o=[t+l/2,r+a/2];e.beginPath(),e.moveTo(s[0],s[1]),e.lineTo(o[0],o[1]),e.moveTo(i[0],i[1]),e.lineTo(c[0],c[1]),e.stroke()}(t,r,l,a,n):"RDP"===e?function(e,t,r,l,a){e.strokeStyle="#000000",e.fillStyle="#000000";e.lineWidth=1;let n=[t-(l=.9*l-4)/2,r-.2*(a=.4*a-4)],s=[t-l/2,r+.2*a],i=[t+l/2-a,r+.2*a],c=[t+l/2-a,r+a],o=[t+l/2,r],h=[t+l/2-a,r-a],p=[t+l/2-a,r-.2*a];e.beginPath(),e.moveTo(n[0],n[1]),e.lineTo(s[0],s[1]),e.lineTo(i[0],i[1]),e.lineTo(c[0],c[1]),e.lineTo(o[0],o[1]),e.lineTo(h[0],h[1]),e.lineTo(p[0],p[1]),e.fill(),e.stroke()}(t,r,l,a,n):"SCT"===e?function(e,t,r,l,a){e.strokeStyle="#000000",e.fillStyle="#000000",a=.5*(l=.9*l-4);e.lineWidth=1;let n=(Math.pow(a/2,2)-Math.pow(l/2,2))/a,s=Math.sqrt(Math.pow(l/2,2)+Math.pow(n,2)),i=Math.atan(2*n/l);e.beginPath(),e.moveTo(t+l/2,r),e.arc(t,r-n,s,i,Math.PI-i,!0),e.arc(t,r+n,s,Math.PI+i,-i,!0),e.stroke(),e.beginPath(),e.moveTo(t+.2*a,r),e.arc(t,r,.2*a,0,2*Math.PI,!1),e.stroke(),e.fill(),e.beginPath(),e.moveTo(t+.5*a,r),e.arc(t,r,.5*a,0,2*Math.PI,!1),e.stroke()}(t,r,l,a,n):"MUD"===e?function(e,t,r,l){e.font=l.toString()+"px Verdana",e.fillStyle="#000000",e.textAlign="center";let a=e.measureText("M").width,n=l<30?0:7;e.fillText("+",t,r+a/2-n)}(t,r,l,n):"FOG"===e&&function(e,t,r,l){e.font=l.toString()+"px Verdana",e.fillStyle="#000000",e.textAlign="center";let a=e.measureText("M").width,n=l<30?0:7;e.fillText("#",t,r+a/2-n)}(t,r,l,n)}class q extends a.a.Component{constructor(e){super(e),this.selected_card=null,this.displaced_card=null}onClickCard(e,t){this.props.ctx.currentPlayer===e&&this.props.ctx.currentPlayer===this.props.playerID&&(this.selected_card!==t?(this.selected_card=t,this.displaced_card=null,this.forceUpdate()):(this.selected_card=null,this.displaced_card=null,this.forceUpdate()))}onClickSlot(e,t,r){if(null===this.selected_card)return;let l=this.props.G.player_hands[this.props.ctx.currentPlayer][this.selected_card];if(R(l)&&-1!==t){let a=r.target.getBoundingClientRect(),n="0"===e?a.bottom-r.clientY:r.clientY-a.top,s=this.props.G.board_cards[t][e].length,i=0;for(let r=0;r!==s;r++){if(i+=r!==s-1?35:120,n<i){let a=this.props.G.board_cards[t][e][r];if(A(this.props.G,this.props.ctx,l,a,e,t)){let l=[t,e,r];if(null===this.displaced_card)return this.displaced_card=l,void this.forceUpdate();if(H(this.displaced_card,l))return this.displaced_card=null,void this.forceUpdate();break}break}}}if(R(l)){if(this.props.ctx.currentPlayer!==e&&"DES"!==l)return;if(null===this.displaced_card)return;this.props.moves.playCard(this.selected_card,t,this.displaced_card),this.selected_card=null,this.displaced_card=null,this.forceUpdate()}else if(F(l)){if(-1!==t)return;this.props.moves.playCard(this.selected_card,t),this.selected_card=null,this.displaced_card=null,this.forceUpdate()}else{if(this.props.ctx.currentPlayer!==e)return;if(-1===t)return;this.props.moves.playCard(this.selected_card,t),this.selected_card=null,this.displaced_card=null,this.forceUpdate()}}onClickFlag(e){this.props.moves.claimFlag(e)}onClickDeck(e){if(null!==this.selected_card){let t=this.props.G.player_hands[this.props.ctx.currentPlayer][this.selected_card];(F(t)||w(t)&&"troop"==e||M(t)&&"tactics"==e)&&(this.props.moves.playCard(this.selected_card,-1),this.selected_card=null,this.displaced_card=null,this.forceUpdate())}this.props.moves.drawCard(e)}onClickPass(){this.props.moves.passTurn()}render(){let e=[],t=[],r="";void 0!==this.props.ctx.gameover&&"0"===this.props.ctx.gameover.winner?r="Winner!":"0"===this.props.ctx.currentPlayer&&(r="Your turn!"),t.push(a.a.createElement("td",{key:t.length,style:{textAlign:"center"}},r));for(let s=0;s<this.props.G.player_hands[0].length;s++)t.push(a.a.createElement("td",{key:t.length,onClick:()=>this.onClickCard("0",s)},a.a.createElement(V,{str:this.props.G.player_hands[0][s],side:"top",selected:s===this.selected_card&&"0"===this.props.ctx.currentPlayer&&"0"===this.props.playerID&&(0===this.props.ctx.numMoves||this.props.G.scout_state[1]>0&&0===this.props.G.scout_state[0])})));for(let s=0;s!==9-this.props.G.player_hands[0].length;s++)t.push(a.a.createElement("td",{key:t.length}));let l=[new Array(this.props.G.discards[0].length).fill(null),new Array(this.props.G.discards[1].length).fill(null)];this.props.G.discards[0].length>0&&this.props.G.discards[0].slice(-1)[0]===this.props.G.seen_cards.slice(-1)[0]&&"0"!==this.props.playerID&&(l[0][this.props.G.discards[0].length-1]="#000000"),this.props.G.discards[1].length>0&&this.props.G.discards[1].slice(-1)[0]===this.props.G.seen_cards.slice(-1)[0]&&"1"!==this.props.playerID&&(l[1][this.props.G.discards[1].length-1]="#000000"),t.push(a.a.createElement("td",{rowSpan:"5",key:t.length},a.a.createElement("table",{id:"tactics_deck",style:{margin:"auto"}},a.a.createElement("tbody",null,a.a.createElement("tr",null,a.a.createElement("td",{onClick:e=>this.onClickSlot("0",-1,e)},a.a.createElement(W,{cards:this.props.G.discards[0],side:"top",show_flag:!1,highlights:l[0]}))),a.a.createElement("tr",null,a.a.createElement("td",{onClick:()=>this.onClickDeck("tactics")},a.a.createElement(V,{str:this.props.G.tactics_deck.length>0?this.props.G.tactics_deck[0]:"",side:"deck"}))),a.a.createElement("tr",null,a.a.createElement("td",{onClick:e=>this.onClickSlot("1",-1,e)},a.a.createElement(W,{cards:this.props.G.discards[1],side:"bottom",show_flag:!1,highlights:l[1]}))))))),e.push(a.a.createElement("tr",{key:e.length},t)),t=[];let n=new Array(2).fill("none");for(let a=0;2!==a;a++)this.props.ctx.currentPlayer===this.props.playerID&&this.props.ctx.currentPlayer===a.toString()&&P(this.props.G,this.props.ctx)&&(n[a]="block");t.push(a.a.createElement("td",{rowSpan:"3",key:t.length},a.a.createElement("table",{id:"troop_deck",style:{margin:"auto"}},a.a.createElement("tbody",null,a.a.createElement("tr",null,a.a.createElement("td",{style:{height:"50px"}},a.a.createElement("input",{type:"button",value:"Pass",style:{margin:"auto",display:n[0]},onClick:()=>this.onClickPass()}))),a.a.createElement("tr",null,a.a.createElement("td",{style:{height:"120px"},onClick:()=>this.onClickDeck("troop")},a.a.createElement(V,{str:this.props.G.troop_deck.length>0?this.props.G.troop_deck[0]:"",side:"deck"}))),a.a.createElement("tr",null,a.a.createElement("td",{style:{height:"50px"}},a.a.createElement("input",{type:"button",value:"Pass",style:{margin:"auto",display:n[1]},onClick:()=>this.onClickPass()})))))));for(let s=0;s<9;s++){let e=this.props.G.board_cards[s][0],r="0"===this.props.G.flag_statuses[s],l=new Array(e.length).fill(null);e.length>0&&e.slice(-1)[0]===this.props.G.seen_cards.slice(-1)[0]&&"0"!==this.props.playerID&&(l[e.length-1]="#000000"),null!==this.displaced_card&&this.displaced_card[0]===s&&"0"===this.displaced_card[1]&&(l[this.displaced_card[2]]="#AAAAAA"),t.push(a.a.createElement("td",{key:t.length,onClick:e=>this.onClickSlot("0",s,e)},a.a.createElement(W,{cards:e,side:"top",show_flag:r,highlights:l})))}e.push(a.a.createElement("tr",{key:e.length},t)),t=[];for(let s=0;s<9;s++)t.push(a.a.createElement("td",{key:t.length,onClick:()=>this.onClickFlag(s)},a.a.createElement(B,{show_flag:null===this.props.G.flag_statuses[s]})));e.push(a.a.createElement("tr",{key:e.length},t)),t=[];for(let s=0;s<9;s++){let e=this.props.G.board_cards[s][1],r="1"===this.props.G.flag_statuses[s],l=new Array(e.length).fill(null);e.length>0&&e.slice(-1)[0]===this.props.G.seen_cards.slice(-1)[0]&&"1"!==this.props.playerID&&(l[e.length-1]="#000000"),null!==this.displaced_card&&this.displaced_card[0]===s&&"1"===this.displaced_card[1]&&(l[this.displaced_card[2]]="#AAAAAA"),t.push(a.a.createElement("td",{key:t.length,onClick:e=>this.onClickSlot("1",s,e)},a.a.createElement(W,{cards:e,side:"bottom",show_flag:r,highlights:l})))}e.push(a.a.createElement("tr",{key:e.length},t)),t=[],r="",void 0!==this.props.ctx.gameover&&"1"===this.props.ctx.gameover.winner?r="Winner!":"1"===this.props.ctx.currentPlayer&&(r="Your turn!"),t.push(a.a.createElement("td",{key:t.length,style:{textAlign:"center"}},r));for(let s=0;s<this.props.G.player_hands[1].length;s++)t.push(a.a.createElement("td",{key:t.length,onClick:()=>this.onClickCard("1",s)},a.a.createElement(V,{str:this.props.G.player_hands[1][s],side:"bottom",selected:s===this.selected_card&&"1"===this.props.ctx.currentPlayer&&"1"===this.props.playerID&&(0===this.props.ctx.numMoves||this.props.G.scout_state[1]>0&&0===this.props.G.scout_state[0])})));return e.push(a.a.createElement("tr",{key:e.length},t)),a.a.createElement("div",null,a.a.createElement("table",{id:"board",style:{margin:"auto"}},a.a.createElement("tbody",null,e)))}}function H(e,t){if(null===e&&null===t)return!0;if(null===e||null===t)return!1;if(e.length!==t.length)return!1;for(let r=0;r!==e.length;r++)if(e[r]!==t[r])return!1;return!0}class $ extends i.b{handleChangeName(e){this.setState({playerName:e.target.value})}handleNewMatch(e){this._createMatch("battle-line",2)}handleRefreshMatches(e){this._updateConnection()}handleJoinMatch(e,t,r){this._joinMatch("battle-line",t,r)}handleLeaveMatch(e,t){this._leaveMatch("battle-line",t)}handleEnterLobby(e){this._enterLobby(this.state.playerName)}handleExitLobby(e){this._exitLobby()}handleStartMatch(e,t,r){this._startMatch("battle-line",{numPlayers:2,matchID:t,playerID:r})}handleExitMatch(e){this._exitMatch()}render(){var e=[],t=[];const r={width:"150px",textAlign:"center",padding:"3px"},l={width:"150px",textAlign:"center",padding:"3px"},n={width:"30px",textAlign:"center",padding:"3px"},s={width:"100px",textAlign:"center",padding:"3px"};t.push(a.a.createElement("th",{style:r},"Match ID")),t.push(a.a.createElement("th",{style:l},"Player 1")),t.push(a.a.createElement("th",{style:n},"vs.")),t.push(a.a.createElement("th",{style:l},"Player 2")),t.push(a.a.createElement("th",{style:s},a.a.createElement("input",{type:"button",value:"New Match",onClick:e=>this.handleNewMatch(e)}))),t.push(a.a.createElement("th",{style:s},a.a.createElement("input",{type:"button",value:"Refresh",onClick:e=>this.handleRefreshMatches(e)}))),e.push(a.a.createElement("tr",null,t));for(var i=[],c=0;c!==this.connection.matches.length;c++){var o=[];let e=this.connection.matches[c];var h=e.players.length>0?e.players[0].name:void 0,p=e.players.length>1?e.players[1].name:void 0;if(o.push(a.a.createElement("td",{style:r},e.matchID)),void 0!==h?o.push(a.a.createElement("td",{style:l},h)):o.push(a.a.createElement("td",{style:l},a.a.createElement("input",{type:"button",value:"Join",onClick:t=>this.handleJoinMatch(t,e.matchID,"0")}))),o.push(a.a.createElement("td",{style:n},"vs.")),void 0!==p?o.push(a.a.createElement("td",{style:l},p)):o.push(a.a.createElement("td",{style:l},a.a.createElement("input",{type:"button",value:"Join",onClick:t=>this.handleJoinMatch(t,e.matchID,"1")}))),h===this.state.playerName||p===this.state.playerName?o.push(a.a.createElement("td",{style:s},a.a.createElement("input",{type:"button",value:"Leave",onClick:t=>this.handleLeaveMatch(t,e.matchID)}))):o.push(a.a.createElement("td",{style:s})),h===this.state.playerName&&void 0!==p||p===this.state.playerName&&void 0!==h){let t=this.state.playerName===h?"0":"1";o.push(a.a.createElement("td",{style:s},a.a.createElement("input",{type:"button",value:"Play",onClick:r=>this.handleStartMatch(r,e.matchID,t)})))}else o.push(a.a.createElement("td",{style:s}));i.push(a.a.createElement("tr",null,o))}if("enter"===this.state.phase)return a.a.createElement("div",null,"Enter name: ",a.a.createElement("input",{type:"text",value:this.state.playerName,onChange:e=>this.handleChangeName(e)}),a.a.createElement("input",{type:"button",value:"Enter Lobby",onClick:e=>this.handleEnterLobby(e)}));if("list"===this.state.phase)return a.a.createElement("div",null,a.a.createElement("input",{type:"button",value:"Exit Lobby",onClick:e=>this.handleExitLobby(e)}),a.a.createElement("br",null),a.a.createElement("table",{id:"matches"},a.a.createElement("thead",null,e),a.a.createElement("tbody",null,i)));if("play"===this.state.phase){var u=a.a.createElement(this.state.runningMatch.app,{matchID:this.state.runningMatch.matchID,playerID:this.state.runningMatch.playerID,credentials:this.state.runningMatch.credentials});return a.a.createElement("div",null,u)}}}class K extends a.a.Component{render(){return a.a.createElement("div",null,a.a.createElement("table",{style:{width:"100%"},bgcolor:"#E4DB86"},a.a.createElement("tbody",null,a.a.createElement("tr",null,a.a.createElement("td",{style:{fontFamily:"Verdana",fontSize:"30px",padding:"10px"}},a.a.createElement("a",{href:"https://rsandzimier.github.io/battleline/",style:{color:"inherit",textDecoration:"none"}},"BATTLE LINE (TEST)")),a.a.createElement("td",{style:{textAlign:"right"}},a.a.createElement("a",{href:"https://github.com/rsandzimier/battleline"},a.a.createElement("img",{id:"github",src:"https://raw.githubusercontent.com/rsandzimier/battleline/master/github_logo.png",style:{height:"50px"},alt:"Github logo"})))))),a.a.createElement("br",null))}}Object(i.a)({game:_,board:q,multiplayer:Object(c.b)({server:"https://battleline-backend.onrender.com"})});var Q=()=>a.a.createElement("div",null,a.a.createElement(K,null),a.a.createElement($,{gameServer:"https://battleline-backend.onrender.com",lobbyServer:"https://battleline-backend.onrender.com",gameComponents:[{game:_,board:q}]}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(Q,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(e=>{e.unregister()}).catch(e=>{console.error(e.message)})}},[[31,1,2]]]);
//# sourceMappingURL=main.31b536bd.chunk.js.map